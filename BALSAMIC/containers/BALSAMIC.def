Bootstrap: yum
OSVersion: 7
MirrorURL: http://mirror.centos.org/centos-%{OSVERSION}/%{OSVERSION}/os/$basearch/
Include: yum

%help
    Bioinformatic analysis pipeline for somatic mutations in cancer.

%labels
    Maintainer Hassan Foroughi Asl <hassan.foroughi@scilifelab.se>
    Description Core container for BALSAMIC
    Version 0.0.1

%post
    yum install -y coreutils
    yum install -y wget
    yum install -y which
    yum install -y bzip2
    yum install -y git
    yum install -y gcc
    yum install -y fontconfig
    # install anaconda
    if [ ! -d /usr/local/anaconda ]; then
        wget https://repo.continuum.io/miniconda/Miniconda3-4.5.12-Linux-x86_64.sh\
           -O ~/anaconda.sh && \
        bash ~/anaconda.sh -b -p /usr/local/anaconda && \
        rm ~/anaconda.sh
    fi

    # set anaconda path
    export PATH=$PATH:/usr/local/anaconda/bin
    conda update -y conda
    conda config --add channels r
    conda config --add channels defaults
    conda config --add channels conda-forge
    conda config --add channels bioconda
    echo "Installing snakemake"
    conda install -y pip=9.0.3
    conda install -y snakemake=4.8.0
    pip install -v -e git+https://github.com/Clinical-Genomics/BALSAMIC.git#egg=BALSAMIC

%environment
    export PATH=$PATH:/usr/local/anaconda/bin
